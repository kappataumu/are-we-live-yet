var Awly=function(){var target=document.getElementsByTagName("img")[0];target="undefined"!=typeof target&&null!=target?target.src:!1;var config={asset:target,cssClassName:"awly",ttfbProdThreshold:25,verbose:!1},_init=function(options){for(var opt in options)config[opt]=options[opt];return debug("Initialized."),config.asset?void _measure_ttfb(config.asset):(debug("Unable to find any <img> in the document."),void debug("You need to explicitly set the asset to be timed."))},_measure_ttfb=function(file){var measure=function(el){return function(){var timer=window.performance.getEntriesByName(el.src),responseStart=timer[0].responseStart.toFixed(0),requestStart=timer[0].requestStart.toFixed(0),ttfb=responseStart-requestStart;_show_panel(ttfb)}},el=new Image;el.onload=measure(el),el.src=file+_cacheBuster()},_show_panel=function(ttfb){debug("TTFB: "+config.asset+" "+ttfb+"ms");var is_production=ttfb<config.ttfbProdThreshold;if(config.verbose||!is_production){var css=_cssText(is_production?"green":"red"),head=document.head||document.getElementsByTagName("head")[0],style=document.createElement("style");style.type="text/css",style.styleSheet?style.styleSheet.cssText=css:style.appendChild(document.createTextNode(css));var panel=document.createElement("div");panel.className=config.cssClassName,panel.innerHTML+=ttfb+"ms",head.appendChild(style),document.body.appendChild(panel)}},_cssText=function(bgColor){return"."+config.cssClassName+" {position: fixed;bottom: 0;right: 0;text-align: center;line-height: 40px;color: white;width: 80px;height: 40px;opacity: 0.3;z-index: 100;background:"+bgColor+";"},_cacheBuster=function(){return"?awly="+Math.random()+(new Date).getTime()},debug=function(msg){config.verbose&&console.debug("[AWLY] %s",msg)};return{run:function(options){_init(options)}}}();